---
import HomeArticleCard from "@/components/HomeArticleCard.astro"
import MainTitle from "@/components/MainTitle.astro"
import Book from "@/icons/Book.astro"
import UpArrow from "@/icons/UpArrow.astro"
import { getActiveLocale, getI18N, resolveLocalizedHref } from "@/locales/index"
import { getCollection } from "astro:content"

const locale = getActiveLocale(Astro)
const i18n = getI18N({ currentLocale: locale })

const articles = (await getCollection("articles")).slice(0, 4)
---

<div class="flex w-full max-w-4xl flex-col sm:w-11/12 md:w-8/12">
	<MainTitle>
		<Book class="size-8" />
		{i18n.ARTICLES}
	</MainTitle>

	<div class="flex w-full flex-col gap-3">
		{
			articles.map((article) => {
				const { slug, data } = article
				const { author, category, cover, description, lang, pageTitle, tags, timestamp, title } =
					data

				return (
					<HomeArticleCard
						author={author}
						description={description}
						lang={lang}
						pageTitle={pageTitle}
						timestamp={timestamp}
						title={title}
					/>
				)
			})
		}
	</div>

	<a
		href={resolveLocalizedHref("/articles", locale)}
		class="mt-6 flex size-4 w-fit select-none gap-2 text-secondary transition-all active:text-primary sm:cursor-pointer sm:hover:gap-1 sm:hover:text-primary"
	>
		<span>{i18n.VIEW_ALL_ARTICLES}</span>

		<UpArrow class="rotate-90" />
	</a>
</div>
